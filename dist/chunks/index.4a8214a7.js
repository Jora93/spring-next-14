import{_ as $}from"./i18next.083d61f0.js";import{S as L,j as et}from"./index.053dea56.js";import{useState as f,useCallback as G,useEffect as S,useRef as Et,useMemo as I,useLayoutEffect as W}from"react";import{d as Y}from"./backend-status-codes.80bfe624.js";import{R as rt,v as Tt,w as yt,b as kt}from"./index.c0392060.js";import{W as it,H as At,O as Ot,s as q}from"./array-sort-by.690dd174.js";import{l as at}from"./lazy.73833dcd.js";import{c as Rt}from"./create-fake-array.68114bc4.js";import{e as ot,u as It}from"./get-data-level.db296203.js";import{s as dt}from"./useSortFavoriteSportsOrdering.f78079af.js";import{u as Ct}from"./useMounted.6d9c5610.js";import{i as ct}from"./fav-data.1c5898b7.js";import{b as mt,i as xt,p as Mt,q as st,s as nt}from"./sport-data.b40f7b49.js";import{u as _}from"./index.ffa75b49.js";import{F as Ft}from"./index.4def701f.js";import{V as jt}from"./index.68ae7eeb.js";import{u as Pt}from"./useStreamConfig.0f45476a.js";import{g as Lt}from"./spec-elems.3577ab05.js";import{u as Nt}from"./useTranslation.70287e96.js";import{u as wt}from"./useDispatch.cd750ed9.js";const Bt=["P1XP2","OverUnder","BothTeamsToScore"],Vt=[...it,...At,...Ot],Gt=({selectedDay:a,isHoursSelected:b,filterDays:d,setSports:E,selectedSports:s,setSelectedSports:p,allSelected:C,setIsLoading:T,setMarketsLoading:g,marketType:x,isMultiSelect:u,availableSports:M,setGamesData:y,sports:k,calendarMarketInfoType:A})=>{const N=_(mt),{mounted:l}=Ct(),[F,X]=f({previous:"",current:""}),U=_(ct),K=G(()=>{var v,h;ot(rt.gForCommand(),{sport:["id","name","alias","order"]},{game:{start_ts:b?N:{"@gte":(v=d[a])==null?void 0:v.start,"@lte":(h=d[a])==null?void 0:h.end},type:{"@in":[0,2]}}},m=>{var D;if(L.MOCKED_DATA){const O=m.sport;E(Object.values(O));return}const P=Object.values(m.data.sport||{}),e=q(P),i=dt(U,e,"id");if(!(i!=null&&i.length)){T(!1),g(!1),j();return}if(E(i),(D=m==null?void 0:m.data)!=null&&D.sport&&l.current){const O=s.some(c=>!!m.data.sport[c]),w=Number(i[0].id);O||p([w]),C?p(i.map(c=>Number(c.id))):s.length||p([w])}},!1)},[U,a,b,d,E,s,p,C]);S(()=>{F.previous.length&&It(F.previous)},[F.current]);const j=G(()=>{var h;T(!0),g(!0);const v=rt.gForSubscribe();if(X({previous:F.current||"",current:v}),s.length&&x!==null){const m=u?"default":(h=k.find(e=>e.id===M[0]))==null?void 0:h.alias,P=u||!x?it:A==="compact"?[x.value]:m==="Soccer"?Bt:Vt;ot(v,{game:[["id","markets_count","start_ts","team1_name","team2_name","team1_id","team2_id","tv_type","video_id","video_id2","video_id3","partner_video_id","is_stat_available","is_blocked","game_number","show_type"]],region:["id","name","alias","order"],competition:["id","order","name"],sport:["id","name","alias","order"],market:["type","name","id","base","express_id","main_order","order"],event:["type","id","price","name","base","order"]},{game:{start_ts:b?N:{"@gte":d[a].start,"@lte":d[a].end},type:{"@in":[0,2]}},sport:{id:{"@in":u?s:M}},market:{type:{"@in":P}}},e=>{var i;if(g(!1),L.MOCKED_DATA){y(e);return}if(!Object.keys((e==null?void 0:e.sport)||{}).length){y(null),T(!1),g(!1);return}e!=null&&e.sport&&l.current&&y(e),Object.keys(e==null?void 0:e.sport).length||((i=k[0])!=null&&i.id&&p([Number(k[0].id)]),T(!1))},!0,e=>{e!=null&&e.sport&&l.current&&y(i=>Tt(i,e,{shouldMergeInFirst:!0,applyEmptyArraysAndObjects:!1}))})}},[s,x,d,a,u,M,N,A,b]);return{getSportsData:K,getGamesData:j}};L.IS_RTL&&$(()=>Promise.resolve({}),["assets/rtl.css"]);const{DesktopCalendar:Ut}=at(()=>$(()=>import("./index.e9b4d45f.js"),["chunks/index.e9b4d45f.js","chunks/index.053dea56.js","chunks/i18next.083d61f0.js","chunks/array-sort-by.690dd174.js","chunks/app-data.da3833f4.js","chunks/index.fbd937ed.js","chunks/backend-status-codes.80bfe624.js","chunks/create-test-id.17a0abc8.js","chunks/create-fake-array.68114bc4.js","chunks/index.ffa75b49.js","chunks/lazy.73833dcd.js","chunks/index.812cdb8e.js","chunks/index.03ce9bd5.js","chunks/style.32a730b7.js","chunks/styled-components.browser.esm.22f548e7.js","chunks/index.9a56940c.js","chunks/useTranslation.70287e96.js","chunks/context.f61a2be2.js","chunks/index.1967089f.js","chunks/index.536e01bf.js","chunks/Skeleton.d4e88166.js","chunks/toConsumableArray.19249869.js","chunks/placements.f27399b1.js","chunks/KeyCode.6413d982.js","chunks/Overflow.5f48b1c8.js","chunks/index.66ee6c8a.js","chunks/col.a0c1837e.js","chunks/CheckOutlined.795713a5.js","chunks/SearchOutlined.02ed5a97.js","chunks/statusUtils.c2dcc692.js","chunks/casino.9f590000.js","chunks/sport-data.b40f7b49.js","chunks/index.c0392060.js","chunks/swarm-command-names.230156ba.js","chunks/useDispatch.cd750ed9.js","chunks/useClickOutside.dbd17ed0.js","chunks/index.34e99d41.js","chunks/index.68ae7eeb.js","chunks/index.2c360109.js","chunks/useUpdateEffect.ee726e5b.js","chunks/useSportsbookConfigs.a1eb5af5.js","chunks/generic.97974c67.js","chunks/route-manipulation.fb85cda5.js","chunks/not-real-sports.64fc4139.js","chunks/useContentHeight.a1c79de7.js","chunks/index.26a56120.js","chunks/index.2650910e.js","chunks/sportsbook.58400eeb.js","chunks/get-data-level.db296203.js"])),{MobileCalendar:Kt}=at(()=>$(()=>import("./index.7c2bae97.js"),["chunks/index.7c2bae97.js","chunks/i18next.083d61f0.js","chunks/index.053dea56.js","chunks/array-sort-by.690dd174.js","chunks/lazy.73833dcd.js","chunks/app-data.da3833f4.js","chunks/index.fbd937ed.js","chunks/backend-status-codes.80bfe624.js","chunks/create-test-id.17a0abc8.js","chunks/create-fake-array.68114bc4.js","chunks/index.ffa75b49.js","chunks/index.71506da4.js","chunks/styled-components.browser.esm.22f548e7.js","chunks/index.812cdb8e.js","chunks/index.c0392060.js","chunks/swarm-command-names.230156ba.js","chunks/sport-data.b40f7b49.js","chunks/useDispatch.cd750ed9.js","chunks/useTranslation.70287e96.js","chunks/context.f61a2be2.js","chunks/index.9fa2e41e.js","chunks/index.1967089f.js","chunks/index.34e99d41.js","chunks/col.a0c1837e.js","chunks/index.66ee6c8a.js","chunks/index.9a56940c.js","chunks/placements.f27399b1.js","chunks/index.68ae7eeb.js","chunks/index.2c360109.js","chunks/useUpdateEffect.ee726e5b.js","chunks/index.536e01bf.js","chunks/Skeleton.d4e88166.js","chunks/toConsumableArray.19249869.js","chunks/KeyCode.6413d982.js","chunks/Overflow.5f48b1c8.js","chunks/CheckOutlined.795713a5.js","chunks/SearchOutlined.02ed5a97.js","chunks/statusUtils.c2dcc692.js","chunks/casino.9f590000.js","chunks/useContentHeight.a1c79de7.js","chunks/usePredefinedStakes.58f7290f.js","chunks/odds.334494eb.js","chunks/socket.c077606d.js","chunks/batch.dcd71b53.js","chunks/user-data.f480309c.js","chunks/index.59a19261.js","chunks/game-current-state.364f0ffb.js","chunks/sport-list.d0c83c34.js","chunks/not-real-sports.64fc4139.js","chunks/live-games-helper.8638cd4e.js","chunks/CalendarOdds.5fcb44ab.js","chunks/index.d930ff85.js","chunks/useOddChange.42d6d46a.js","chunks/index.c41901f2.js","chunks/index.092cd2c1.js","chunks/useOpenLoginPopup.d27706ba.js","chunks/custom-categories.e4debdf9.js","chunks/route-manipulation.fb85cda5.js","chunks/index.fcbc691d.js","chunks/useSearchParams.0c3b0efc.js","chunks/useDoBet.0560f246.js","chunks/editBetActions.91db0d9c.js","chunks/edit-bet.f841d32c.js","chunks/getAdvancedMultipleGeneralField.a271e2a8.js","chunks/counterOffer.671956cb.js","chunks/useEventbus.f35d817d.js","chunks/EmptyOddGroup.d87d06ac.js","chunks/EmptyOdd.f2ae87eb.js","chunks/index.c08ef8e3.js","chunks/index.3dcc1bea.js","chunks/useMounted.6d9c5610.js","chunks/index.2c227bf4.js","chunks/index.652e9765.js","chunks/api-post-message-sender.98c07ac7.js","chunks/useSbRouteMatch.6006fa30.js","chunks/index.2650910e.js","chunks/sportsbook.58400eeb.js","chunks/get-data-level.db296203.js"])),zt=7,Z=-1,pe=()=>{const[a,b]=f([]),[d,E]=f(0),[s,p]=f([]),[C,T]=f(null),[g,x]=f("start_ts"),u=_(xt),M=_(Lt),y=_(Mt),k=_(ct),A=_(mt),[N,l]=f(!0),[F,X]=f(!1),[U,K]=f(!1),[j,v]=f(!1),h=Et(""),m=_(st),{t:P}=Nt(),e=wt();Pt();const i=I(()=>m==="expanded",[m]),D=I(()=>a.filter(t=>s.some(r=>r.id===t)),[a,s]),O=I(()=>D.length>1,[D.length]),w=I(()=>{const t=[];return Rt(zt).forEach(r=>{t.push({start:Y().startOf("date").add(r,"day").unix(),end:Y().endOf("date").add(r,"day").unix(),key:r,value:Y().startOf("date").add(r,"day").format(L.DT.shortDate),name:Y().startOf("date").add(r,"day").format(L.DT.shortDate)})}),t},[]),c=I(()=>A==null?void 0:A["@gt"],[A]),pt=G(t=>{K(t)},[]),ft=G(t=>{c&&e(nt({option:"All",date:!1,count:-1,name:P("sportsbook.allEvents")})),E(t)},[c]),ut=G(t=>x(t),[]),lt=_(st),{getGamesData:H,getSportsData:tt}=Gt({selectedDay:d,isHoursSelected:c,filterDays:w,setSports:p,selectedSports:a,setSelectedSports:b,allSelected:F,setIsLoading:l,setMarketsLoading:K,marketType:y,isMultiSelect:O,availableSports:D,setGamesData:T,sports:s,calendarMarketInfoType:lt});S(()=>{E(c?Z:t=>t===Z?0:t)},[c]),W(()=>{d!==Z&&tt()},[d]),S(()=>{if(k.length){const t=q([...s]),r=dt(k,t,"id");r&&p(r)}else p(q([...s]))},[k.length]),W(()=>{c&&tt()},[c]),W(()=>{a.length>1&&O&&(l(!0),H())},[D]),S(()=>{j||H()},[y]),S(()=>{j&&(v(!1),H())},[j]);const _t=(t,r)=>t.filter(o=>o.game_id===r),B=I(()=>{if(C){const t=yt(C);return q(t==null?void 0:t.games,"start_ts").map(o=>{const R=t.competitions.find(n=>n.id===o.competition_id),z=t.regions.find(n=>n.id===(R==null?void 0:R.region_id)),J=t.sports.find(n=>n.id===(z==null?void 0:z.sport_id));J&&(o.sportId=J.id);const V=i?_t(t.markets,o.id):t.markets.find(n=>n.game_id===o.id),Q=i?V.map(n=>n.eventIds).flat():V==null?void 0:V.eventIds,vt=t.events.filter(n=>Q==null?void 0:Q.includes(n.id));if(u&&u[o.id]){const n=u[o.id];if(n&&n[0]){const{provider_id:ht,video_id:Dt,allow_zero_balance:St=0,is_guest:bt=0}=n[0];o.tv_type=ht,o.video_id=Dt,o.hasVideoStream=!0,o.allow_zero_balance=St,o.guest=!!Number(bt)}}return{competition:R,region:z,sport:J,market:V||[],events:vt,game:o}})}return[]},[C,u]),gt=I(()=>g==="competition"?[...B].sort((t,r)=>{var o,R;return(((o=t==null?void 0:t.competition)==null?void 0:o.order)||0)-(((R=r==null?void 0:r.competition)==null?void 0:R.order)||0)}):[...B],[B,g]);return S(()=>{B.length&&l(!1)},[B]),W(()=>{var t;L.MOCKED_DATA||(l(!0),h.current=((t=s.find(r=>r.id===a[0]))==null?void 0:t.alias)||"",p([]),s.length||T(null))},[d,c]),S(()=>{M||kt()},[M]),S(()=>()=>{e(nt({option:"All",date:!1,count:-1,name:P("sportsbook.allEvents")}))},[]),et.jsx(jt,{desktop:Ut,mobile:Kt,innerProps:{selectedSports:a,setSelectedSports:b,filterDays:w,selectedDay:d,setSelectedDay:ft,sports:s,dataToRender:gt,isLoading:N,setAllSelected:X,setMarketsLoading:pt,setGamesLoading:l,marketsLoading:U,prevSelectedSport:h.current,setShouldUpdateGames:v,availableSports:D,isMultiSelect:O,changeSortBy:ut,sortBy:g},fallback:et.jsx(Ft,{})})};export{pe as S};
